# 승격 기준 (Gates) 설정
# Challenger가 Champion을 대체하기 위한 조건

name: default_gates
version: 1
created_at: "2026-02-05"

# ══════════════════════════════════════════════════════════════
# 1. 점수 기준
# ══════════════════════════════════════════════════════════════
score_gates:
  # 평균 점수 개선 최소치
  avg_score_improvement: 3

  # 최소 절대 점수 (이 이하면 무조건 실패)
  min_absolute_score: 70

  # 점수 하락 허용 범위 (개별 샘플)
  max_regression_per_sample: 5

  # Golden 샘플 점수 범위 통과 필수
  golden_must_pass: true

# ══════════════════════════════════════════════════════════════
# 2. 결함 태그 기준
# ══════════════════════════════════════════════════════════════
defect_gates:
  # 치명 태그 (발생 시 자동 실패)
  critical_tags:
    - MISSING_REQUIRED_ITEM

  # 치명 태그 허용 케이스 수 (0 = 하나도 안 됨)
  critical_tag_max_cases: 0

  # 총 태그 수 감소 필수
  require_tag_reduction: true

  # 특정 태그 감소 요구 (선택)
  target_tag_reductions:
    - tag: NO_EVIDENCE_OR_CITATION
      min_reduction: 1    # 최소 1개 케이스에서 감소

# ══════════════════════════════════════════════════════════════
# 3. 안정성 기준 (선택)
# ══════════════════════════════════════════════════════════════
stability_gates:
  enabled: false           # true면 seed_runs > 1 필요
  max_score_variance: 5    # 동일 샘플 반복 실행 시 점수 분산 한계

# ══════════════════════════════════════════════════════════════
# 4. 비용/시간 기준 (선택)
# ══════════════════════════════════════════════════════════════
cost_gates:
  enabled: false
  max_token_increase_pct: 20    # 토큰 사용량 증가 한계 (%)
  max_time_increase_pct: 30     # 실행 시간 증가 한계 (%)

# ══════════════════════════════════════════════════════════════
# 판정 로직
# ══════════════════════════════════════════════════════════════
verdict_rules:
  # 모든 게이트 통과 필요
  require_all: true

  # 판정 결과
  # PROMOTE: Challenger → Champion 승격
  # REVIEW: 수동 검토 필요
  # REJECT: Challenger 폐기

  # REVIEW 조건 (PROMOTE는 아니지만 완전 실패도 아닌 경우)
  review_if:
    - "avg_score_improvement >= 1 AND avg_score_improvement < 3"
    - "tag_reduction = 0 AND score_improvement >= 3"

notes: |
  MVP 단계에서는 단순한 기준으로 시작:
  - 평균 +3점 이상
  - 치명 태그 0개
  - 총 태그 감소

  안정화되면 stability_gates, cost_gates 활성화 검토
